{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "Tasks"
    },
    "designerId": "2733923a-f012-4fc8-8e51-034b2e4115e3",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskview #taskList",
                "designer|targetType": "Ext.dataview.List",
                "fn": "select",
                "implHandler": [
                    "this.getTaskView().push({",
                    "    xtype: 'taskdetails',",
                    "    title: 'Viewing Task',",
                    "    data: record.getData()",
                    "});"
                ],
                "name": "select"
            },
            "name": "select",
            "designerId": "7735ae5d-92c3-496c-b2f6-c356727ce4f8"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskview #editButton",
                "designer|params": [
                    "target"
                ],
                "designer|targetType": null,
                "fn": "edit",
                "implHandler": [
                    "// Get selected reocrd",
                    "var record = this.getTaskList().getSelection()[0];",
                    "",
                    "// Show form",
                    "this.getTaskView().push({",
                    "    xtype: 'taskform',",
                    "    title: 'Edit Task',",
                    "    record: record",
                    "});"
                ],
                "name": "tap"
            },
            "name": "edit",
            "designerId": "c22ef67f-57dd-4d84-be23-5cc6b3d25fad"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskview #addButton",
                "designer|targetType": "Ext.Button",
                "fn": "add",
                "implHandler": [
                    "// Remove current selection",
                    "this.getTaskList().deselectAll();",
                    "",
                    "// Create new record",
                    "var record = Ext.create('model.task');",
                    "",
                    "// Show form",
                    "this.getTaskView().push({",
                    "    xtype: 'taskform',",
                    "    title: 'Add Task',",
                    "    record: record",
                    "});"
                ],
                "name": "tap"
            },
            "name": "add",
            "designerId": "4f84813c-6e46-4fe3-b20d-94176fe522ca"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskview #saveButton",
                "designer|targetType": "Ext.Button",
                "fn": "save",
                "implHandler": [
                    "var form = this.getTaskForm(),",
                    "    record = form.getRecord(),",
                    "    store = Ext.getStore('Tasks');",
                    "",
                    "// Update associated record with form values",
                    "form.updateRecord(record);",
                    "",
                    "// Run validation",
                    "var errors = record.validate();",
                    "",
                    "// Valid",
                    "if (errors.isValid()) {",
                    "",
                    "    // Add to store if new record",
                    "    if (record.phantom) {",
                    "",
                    "        // TODO: Assign the record's ID from data source",
                    "        // Normally, this value would be auto-generated,",
                    "        // or returned from the server",
                    "        var id = store.getData().all.length + 1;",
                    "        record.set('id', id);",
                    "",
                    "        // Add to store",
                    "        store.add(record);",
                    "",
                    "    }",
                    "",
                    "    // Commit changes",
                    "    store.sync();",
                    "",
                    "}",
                    "",
                    "// Back to list",
                    "this.getTaskView().reset();",
                    "",
                    "// Ensure current record is selectd",
                    "// Deleselect current, and prevent event from firing",
                    "this.getTaskList().select(record, false, true);"
                ],
                "name": "tap"
            },
            "name": "save",
            "designerId": "5878c17a-f4d1-41df-9b54-9bb9f34dfdd1"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskview #removeButton",
                "designer|targetType": "Ext.Button",
                "fn": "remove",
                "implHandler": [
                    "var me = this,",
                    "    title = 'Delete Task',",
                    "    message = 'Are you sure you want to delete this task?';",
                    "",
                    "Ext.Msg.confirm(title, message, function(response) {",
                    "    if (response == 'yes') {",
                    "",
                    "\t\tvar store = Ext.getStore('Tasks'),",
                    "    record = me.getTaskList().getSelection()[0];",
                    "",
                    "\t\tstore.remove(record);",
                    "",
                    "\t\t// Back to list view",
                    "\t\tme.getTaskView().reset();",
                    "",
                    "    }",
                    "});"
                ],
                "name": "tap"
            },
            "name": "remove",
            "designerId": "2b137530-1622-48a6-bbbd-1c489f42864e"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "taskview > *",
                "designer|targetType": "Ext.dataview.DataView",
                "fn": "onNavigate",
                "implHandler": [
                    "// Show/hide buttons based on view",
                    "",
                    "var add = this.getAddButton(),",
                    "    edit = this.getEditButton(),",
                    "    remove = this.getRemoveButton();",
                    "",
                    "switch (component.getItemId()) {",
                    "    case 'taskList':",
                    "        add.show();",
                    "        edit.hide();",
                    "        remove.hide();",
                    "        break;",
                    "    case 'taskDetails':",
                    "        add.hide();",
                    "        edit.show();",
                    "        remove.show();",
                    "        break;",
                    "    case 'taskForm':",
                    "        add.hide();",
                    "        edit.hide();",
                    "        remove.hide();",
                    "        break;",
                    "}",
                    ""
                ],
                "name": "show"
            },
            "name": "onNavigate",
            "designerId": "e7e0faf1-84b9-4072-a9cb-40c4ec2de987"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "taskView",
                "selector": "taskview"
            },
            "name": "taskView",
            "designerId": "359761db-20d2-41e7-b6fe-c0629136513f"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "taskList",
                "selector": "taskview #taskList"
            },
            "name": "taskList",
            "designerId": "26877a74-20c1-491f-a3e2-31bcda2feed3"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "taskForm",
                "selector": "taskform"
            },
            "name": "taskForm",
            "designerId": "3cd1bab9-a06d-4473-acc2-4e87a3f5ba06"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "taskDetails",
                "selector": "taskdetails"
            },
            "name": "taskDetails",
            "designerId": "59e096d1-9fb5-41c9-8500-87d7fab27e51"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "addButton",
                "selector": "taskview #addButton"
            },
            "name": "addButton",
            "designerId": "3e97ad92-d279-4203-972b-358b34dd910d"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "editButton",
                "selector": "taskview #editButton"
            },
            "name": "editButton",
            "designerId": "6a8ca3a5-48b4-4c2b-a207-f2a312f116c7"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "removeButton",
                "selector": "taskview #removeButton"
            },
            "name": "removeButton",
            "designerId": "56a96f95-7521-4681-a72d-c8763e227ef6"
        }
    ]
}